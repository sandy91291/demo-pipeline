## common functions for the pipeline